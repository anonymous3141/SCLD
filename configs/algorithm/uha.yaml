# Uncorrected Hamiltonian Annealing (UHA)
name: uha
step_size: ${target.ud_langevin.step_size}
batch_size: ${target.all.batch_size}
iters: 40000
init_std: 10. #${target.ud_langevin.initial_scale}
num_steps: 128
loss: "elbo"  # elbo or var_grad
grad_clip: 1.
max_diffusion: 1. #${target.ud_langevin.max_diffusion}
init_momentum: .01 #${target.ud_langevin.init_momentum}
learn_prior: True
learn_betas: True
learn_friction: True
learn_diffusion_coefficient: True

defaults:
  - noise_schedule: const

noise_schedule:
  reverse: False

#Step 0: ELBO -16.20680809020996; Δ lnZ -0.09211158752441406; reverse_ESS 0.06369666755199432
#Step 400: ELBO -8.949786186218262; Δ lnZ 0.046143531799316406; reverse_ESS 0.07632744312286377
#Step 800: ELBO -6.89238977432251; Δ lnZ -0.05507946014404297; reverse_ESS 0.09851358830928802
#Step 1200: ELBO -5.233388900756836; Δ lnZ 0.031375885009765625; reverse_ESS 0.12522247433662415
#Step 1600: ELBO -3.7332422733306885; Δ lnZ -0.0281829833984375; reverse_ESS 0.16237369179725647
#Step 2000: ELBO -2.9789907932281494; Δ lnZ -0.02746868133544922; reverse_ESS 0.18303996324539185
#Step 2400: ELBO -2.262211561203003; Δ lnZ -0.00019168853759765625; reverse_ESS 0.24722960591316223
#Step 2800: ELBO -1.7712329626083374; Δ lnZ -0.02057504653930664; reverse_ESS 0.2886106073856354
#Step 3200: ELBO -1.6176202297210693; Δ lnZ -0.027462482452392578; reverse_ESS 0.29234468936920166
#Step 3600: ELBO -1.4391140937805176; Δ lnZ -0.034743309020996094; reverse_ESS 0.30610010027885437
#Step 4000: ELBO -1.2439866065979004; Δ lnZ -0.011083126068115234; reverse_ESS 0.3452901840209961
#Step 4400: ELBO -1.1632527112960815; Δ lnZ -0.0010051727294921875; reverse_ESS 0.35378551483154297
#Step 4800: ELBO -1.0285515785217285; Δ lnZ 0.0018215179443359375; reverse_ESS 0.386486679315567
#Step 5200: ELBO -0.9259973168373108; Δ lnZ 0.029656410217285156; reverse_ESS 0.4106527268886566
#Step 5600: ELBO -0.8959085941314697; Δ lnZ -0.02473592758178711; reverse_ESS 0.43522366881370544
#Step 6000: ELBO -0.774265468120575; Δ lnZ 0.056923866271972656; reverse_ESS 0.43668508529663086
#Step 6400: ELBO -0.8374255895614624; Δ lnZ -0.050864219665527344; reverse_ESS 0.4501645267009735
#Step 6800: ELBO -0.7447112202644348; Δ lnZ 0.004905223846435547; reverse_ESS 0.4583858251571655
#Step 7200: ELBO -0.681878924369812; Δ lnZ 0.015392780303955078; reverse_ESS 0.4912191927433014
#Step 7600: ELBO -0.7138945460319519; Δ lnZ -0.028023242950439453; reverse_ESS 0.5092935562133789
#Step 8000: ELBO -0.6636298298835754; Δ lnZ 0.011086463928222656; reverse_ESS 0.5157744288444519
#Step 8400: ELBO -0.5825511813163757; Δ lnZ 0.01597881317138672; reverse_ESS 0.5743607878684998
#Step 8800: ELBO -0.5932506322860718; Δ lnZ 0.017099857330322266; reverse_ESS 0.5631898641586304
#Step 9200: ELBO -0.4999174475669861; Δ lnZ 0.026732444763183594; reverse_ESS 0.6067427396774292
#Step 9600: ELBO -0.4519505798816681; Δ lnZ 0.029166698455810547; reverse_ESS 0.6267103552818298